## Ghi chú quy trình Docker cho dự án `payload` (2025-12-16)

### 1. Chuẩn bị & vị trí chạy lệnh

- **Thư mục dự án**: `D:\SND AI\payload\payload`
- **Yêu cầu**: Docker Desktop phải chạy OK, kiểm tra bằng:

```bash
docker info
```

Nếu không còn lỗi kiểu *"Docker Desktop is unable to start"* thì mới tiếp tục.

### 2. Build Docker image

- **Dockerfile** đặt trong thư mục `payload/`.
- Cấu hình chính trong `Dockerfile`:
  - Giai đoạn build:
    - Base image: `maven:3.9.5-eclipse-temurin-17`
    - Làm việc tại `/app`
    - `COPY . .`
    - Build jar:

```bash
mvn -q -B package -DskipTests
```

  - Giai đoạn chạy:
    - Base image: `eclipse-temurin:17-jre-alpine`
    - Copy JAR từ `/app/target/*.jar` sang `/app.jar`
    - Chạy:

```bash
java -XX:+HeapDumpOnOutOfMemoryError -jar /app.jar
```

- **Lệnh build image** (chạy trong thư mục `D:\SND AI\payload\payload`):

```bash
cd "D:\SND AI\payload\payload"
docker build -t payload-app .
```

### 3. Đồng bộ phiên bản Java giữa Maven và Docker

- File `pom.xml`:
  - Thuộc tính:

```xml
<properties>
    <!-- Sử dụng Java 17 để tương thích với image Docker (eclipse-temurin 17) -->
    <java.version>17</java.version>
</properties>
```

- Mục đích: tránh lỗi Maven kiểu *"release version 24 not supported"* do image chỉ hỗ trợ JDK 17.

### 4. Chạy container

- Sau khi build thành công, chạy container:

```bash
docker run --rm -p 8080:8080 payload-app
```

- Ý nghĩa:
  - **`--rm`**: tự xoá container sau khi dừng.
  - **`-p 8080:8080`**: map port 8080 của máy host sang port 8080 trong container.

- Truy cập ứng dụng:
  - `http://localhost:8080` (hoặc các endpoint API mà ứng dụng cung cấp).


